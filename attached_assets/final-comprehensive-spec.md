# מפרט מלא סופי - מערכת ניתוח השקעות נדל"ן תלם נדל"ן

## חלק א': סקירה כללית ומטרות המערכת

### 1. מטרת המערכת
מערכת לניתוח ומודלינג של השקעות נדל"ן בקפריסין, המיועדת עבור חברת תלם נדל"ן. המערכת תאפשר יועצי נדל"ן לעבוד עם משקיעים פוטנציאליים על ניתוח השקעות, חישובי תשואה, וסימולציות של אפשרויות מימון שונות.

### 2. משתמשי המערכת
- **יועצי נדל"ן**: בעלי הרשאות מורחבות, יכולים לנהל משקיעים ומחשבונים
- **משקיעים**: יכולים לראות ולנהל את המחשבונים שלהם
- **אין אפשרות הרשמה עצמית למשקיעים** - רק יועץ יכול ליצור משקיעים חדשים במערכת

### 3. תכונות עיקריות
1. ניהול משקיעים ופרופילים
2. יצירה וניהול של מחשבוני השקעה
3. ניתוח השוואתי של נכסי נדל"ן שונים
4. מודלים ותרחישים של משכנתאות ומימון
5. ניתוחי תזרים מזומנים
6. ניתוחי רגישות
7. הצגה ויזואלית אינטראקטיבית של נתונים
8. תמיכה מלאה בשתי שפות (עברית ואנגלית)
9. תמיכה בשני מטבעות (אירו ושקל)
10. אפשרות שילוב עתידי כ״אזור משקיעים״ באתר החברה

### 4. טכנולוגיות מוצעות
- **Frontend**: React + TypeScript, Next.js
- **Backend**: Node.js + Express
- **Database**: PostgreSQL עם Prisma/Drizzle ORM
- **UI Library**: Shadcn UI / TailwindCSS
- **State Management**: React Query + Context API
- **Charts**: Recharts / Chart.js
- **Internationalization**: i18next
- **Caching**: Redis לנתונים שמתעדכנים לעיתים רחוקות (שערי חליפין, ריביות)
- **API Documentation**: OpenAPI/Swagger
- **Security**: API Gateway לניטור תעבורה והגנה נוספת
- **Performance**: Web Workers לחישובים כבדים בצד הלקוח

## חלק ב': ארכיטקטורת מערכת ומבנה נתונים

### 1. מבנה המערכת
```
- Frontend
  - pages (מסכים ראשיים)
  - components (רכיבים משותפים)
  - hooks (הגיון משותף)
  - lib (פונקציות עזר)
  - context (ניהול מצב)
  - types (טיפוסי TypeScript)
  - workers (Web Workers לחישובים כבדים)

- Backend
  - api (נקודות קצה)
  - models (מודלים עסקיים)
  - services (שירותים)
  - utils (כלי עזר)
  - config (הגדרות)
  - middleware (שכבת ביניים)
  - gateway (API Gateway)
```

### 2. חוזי API ותיעוד
- שימוש ב-OpenAPI/Swagger לתיעוד מפורט ומקיף של ה-API
- הגדרה ברורה של גבולות האחריות בין Frontend ל-Backend
- תיעוד פרוטוקולי התקשורת והפורמטים המדויקים להעברת נתונים
- הגדרות ברורות לאינטגרציה עתידית עם מערכת ה-CRM
- תיעוד קודי שגיאה והודעות מערכת

### 3. מודל נתונים (סכמה)

#### משתמשים (Users)
```typescript
interface User {
  id: number;
  username: string;
  password: string; // מוצפן
  email: string; // שדה חובה
  phone: string; // שדה אופציונלי
  name: string;
  role: "advisor" | "investor";
  status: "active" | "inactive"; // סטטוס משתמש
  lastLogin: Date | null; // מעקב אחר פעילות
  twoFactorEnabled: boolean; // רק עבור יועצים
  twoFactorSecret: string | null; // מוצפן
  createdAt: Date;
  updatedAt: Date; // מעקב אחר עדכונים
  createdBy: number | null; // מי יצר את המשתמש
  updatedBy: number | null; // מי עדכן את המשתמש לאחרונה
}

// Foreign Keys:
// - createdBy -> User.id
// - updatedBy -> User.id
```

#### הגדרות מערכת (SystemSettings)
```typescript
interface SystemSettings {
  id: number;
  key: string; // מפתח ההגדרה (למשל "default_interest_rate_cyprus")
  value: string; // ערך ההגדרה
  category: string; // קטגוריה (למשל "rates", "costs")
  description: string; // תיאור ההגדרה
  updatedAt: Date;
  updatedBy: number; // מי עדכן את ההגדרה לאחרונה
}

// Foreign Keys:
// - updatedBy -> User.id
```

#### מחשבונים (Calculators)
```typescript
interface Calculator {
  id: number;
  userId: number; // המשקיע שהמחשבון שייך לו
  name: string;
  selfEquity: number; // בשקלים
  hasMortgage: boolean;
  hasPropertyInIsrael: boolean;
  
  // ריביות ותקופות
  israelInterestRate: number; // ריבית משכנתא בישראל
  israelLoanTerm: number; // תקופת משכנתא בישראל בשנים
  cyprusInterestRate: number; // ריבית משכנתא בקפריסין
  cyprusLoanTerm: number; // תקופת משכנתא בקפריסין בשנים
  
  // העדפות מימון (רק אחת יכולה להיות true)
  clientPreference: "positive_cash_flow" | "low_interest" | "high_yield" | "max_financing" | "long_term" | null;
  
  // עלויות נלוות ופרמטרים
  mortgageFileCost: number; // עלות תיק משכנתא
  appraiserCost: number; // עלות שמאי
  exchangeRate: number; // שער חליפין שקל/אירו
  vatRate: number; // שיעור מע"מ
  
  // שדות חדשים
  status: "draft" | "active" | "archived"; // סטטוס המחשבון
  version: number; // מספר גרסה למעקב שינויים
  lastCalculationDate: Date | null; // תאריך החישוב האחרון
  notes: string | null; // הערות לגבי המחשבון
  isTemplate: boolean; // האם זהו תבנית מחשבון
  
  createdAt: Date;
  updatedAt: Date;
  createdBy: number; // היועץ שיצר את המחשבון
  updatedBy: number | null; // מי עדכן את המחשבון לאחרונה
}

// Foreign Keys:
// - userId -> User.id
// - createdBy -> User.id
// - updatedBy -> User.id
```

#### נכסים (Properties)
```typescript
interface Property {
  id: number;
  name: string;
  priceWithoutVAT: number; // באירו
  monthlyRent: number; // שכירות פוטנציאלית באירו
  guaranteedRent: number | null; // שכירות מובטחת אם יש
  deliveryDate: string; // תאריך מסירה צפוי
  bedrooms: number; // מספר חדרי שינה
  
  // תכונות נוספות
  hasFurniture: boolean;
  hasPropertyManagement: boolean;
  hasRealEstateAgent: boolean;
  
  // שדות למעקב
  createdAt: Date;
  updatedAt: Date;
  createdBy: number; // היועץ שהוסיף את הנכס
  updatedBy: number | null; // מי עדכן את הנכס לאחרונה
}

// Foreign Keys:
// - createdBy -> User.id
// - updatedBy -> User.id
```

#### השקעות (Investments)
```typescript
interface Investment {
  id: number;
  calculatorId: number;
  propertyId: number; // קישור לטבלת הנכסים
  
  // נתונים ספציפיים להשקעה זו (אם שונים מהנכס הבסיסי)
  priceOverride: number | null; // מחיר ספציפי להשקעה זו אם שונה מהנכס
  monthlyRentOverride: number | null; // שכירות ספציפית להשקעה זו אם שונה
  
  // שדות למעקב
  createdAt: Date;
  updatedAt: Date;
  createdBy: number; // מי יצר את ההשקעה
  updatedBy: number | null; // מי עדכן את ההשקעה לאחרונה
}

// Foreign Keys:
// - calculatorId -> Calculator.id
// - propertyId -> Property.id
// - createdBy -> User.id
// - updatedBy -> User.id
```

#### תרחישי משכנתא (MortgageScenarios)
```typescript
interface MortgageScenario {
  id: number;
  calculatorId: number;
  investmentId: number | null;
  name: string; // שם התרחיש
  location: "israel" | "cyprus" | "hybrid";
  loanAmount: number; // באירו
  interestRate: number;
  termYears: number;
  
  // עלויות לפי מיקום
  appraiserCost: number | null; // ישראל
  mortgageFileCost: number | null; // ישראל
  cyprusMortgageFeeRate: number | null; // קפריסין
  
  // תוצאות חישוב
  monthlyPayment: number; // תשלום חודשי מחושב
  totalInterest: number; // סך הריבית לתקופה
  
  // שדות למעקב
  isRecommended: boolean; // האם תרחיש מומלץ
  createdAt: Date;
  updatedAt: Date;
  createdBy: number; // מי יצר את התרחיש
  updatedBy: number | null; // מי עדכן את התרחיש לאחרונה
}

// Foreign Keys:
// - calculatorId -> Calculator.id
// - investmentId -> Investment.id
// - createdBy -> User.id
// - updatedBy -> User.id
```

#### היסטוריית חישובים (CalculationHistory)
```typescript
interface CalculationHistory {
  id: number;
  calculatorId: number;
  snapshot: string; // JSON של נתוני המחשבון בזמן החישוב
  results: string; // JSON של תוצאות החישוב
  calculationType: "investment_comparison" | "sensitivity" | "cashflow" | "mortgage";
  createdAt: Date;
  createdBy: number; // מי ביצע את החישוב
}

// Foreign Keys:
// - calculatorId -> Calculator.id
// - createdBy -> User.id
```

#### לוג פעולות (AuditLog)
```typescript
interface AuditLog {
  id: number;
  userId: number; // המשתמש שביצע את הפעולה
  entityType: string; // סוג הישות (מחשבון, השקעה, משכנתא)
  entityId: number; // מזהה הישות
  action: "create" | "update" | "delete" | "view"; // סוג הפעולה
  details: string; // פרטי הפעולה בפורמט JSON
  timestamp: Date;
  ipAddress: string;
}

// Foreign Keys:
// - userId -> User.id
```

#### התראות (Notifications)
```typescript
interface Notification {
  id: number;
  userId: number; // המשתמש שההתראה מיועדת לו
  title: string;
  message: string;
  type: "info" | "warning" | "error" | "success";
  isRead: boolean; // האם ההתראה נקראה
  createdAt: Date;
  relatedEntityType: string | null; // סוג הישות הקשורה (אם יש)
  relatedEntityId: number | null; // מזהה הישות הקשורה (אם יש)
}

// Foreign Keys:
// - userId -> User.id
```

### 4. סנכרון נתונים
* כל הנתונים יישמרו במסד נתונים מרכזי
* סנכרון בזמן אמת בין הלקוח לשרת באמצעות API
* שמירה אוטומטית של שינויים
* מערכת לוג מובנית שתעקוב אחר שינויים מהותיים
* שימוש ב-Redis לקישינג (caching) של נתונים שמתעדכנים לעיתים רחוקות

### 5. אינדקסים במסד הנתונים
```sql
-- אינדקסים למשתמשים
CREATE INDEX idx_user_status ON users(status);
CREATE INDEX idx_user_role ON users(role);
CREATE INDEX idx_user_created_by ON users(createdBy);

-- אינדקסים למחשבונים
CREATE INDEX idx_calculator_user ON calculators(userId);
CREATE INDEX idx_calculator_status ON calculators(status);
CREATE INDEX idx_calculator_created_by ON calculators(createdBy);
CREATE INDEX idx_calculator_is_template ON calculators(isTemplate);

-- אינדקסים להשקעות
CREATE INDEX idx_investment_calculator ON investments(calculatorId);
CREATE INDEX idx_investment_property ON investments(propertyId);

-- אינדקסים לנכסים
CREATE INDEX idx_property_price ON properties(priceWithoutVAT);
CREATE INDEX idx_property_bedrooms ON properties(bedrooms);
CREATE INDEX idx_property_created_by ON properties(createdBy);

-- אינדקסים לתרחישי משכנתא
CREATE INDEX idx_mortgage_calculator ON mortgage_scenarios(calculatorId);
CREATE INDEX idx_mortgage_investment ON mortgage_scenarios(investmentId);
CREATE INDEX idx_mortgage_location ON mortgage_scenarios(location);

-- אינדקסים להיסטוריית חישובים
CREATE INDEX idx_calculation_history_calculator ON calculation_history(calculatorId);
CREATE INDEX idx_calculation_history_type ON calculation_history(calculationType);

-- אינדקסים להתראות
CREATE INDEX idx_notification_user ON notifications(userId);
CREATE INDEX idx_notification_read ON notifications(isRead);
```

## חלק ג': מסכים עיקריים ותזרימי משתמש

### 1. מסך כניסה והרשאות
- כניסה פשוטה עם שם משתמש וסיסמה
- **אין** אפשרות הרשמה למשקיעים חדשים - רק יועץ יכול ליצור משתמשים
- הזדהות והרשאות לפי תפקידים (יועץ/משקיע)
- אימות דו-שלבי (2FA) לחשבונות יועצים בלבד
- מערכת שחזור סיסמה באמצעות אימייל
- הגבלת ניסיונות כניסה שגויים
- הצגת CAPTCHA לאחר 3 ניסיונות כניסה כושלים

### 2. דף הבית / לוח בקרה
- סקירה כללית של כל המחשבונים והמשקיעים (ליועצים)
- סקירת המחשבונים האישיים (למשקיעים)
- כפתור בולט ליצירת מחשבון חדש
- חיפוש וסינון משקיעים ומחשבונים
- הצגת פעילות אחרונה והודעות מערכת
- סטטיסטיקה בסיסית (מספר מחשבונים פעילים, מספר משקיעים)
- מרכז התראות עם אפשרויות ניהול וסינון התראות

### 3. דף משקיעים (ליועצים)
- רשימת כל המשקיעים
- כפתור ליצירת משקיע חדש במיקום בולט למעלה
- אפשרויות סינון וחיפוש
- כרטיסיות משקיעים עם מידע תמציתי
- לכל משקיע: כפתור למחשבון חדש (בעברית), כפתור צפייה בפרטים (בעברית)
- אפשרות להפעלה/השבתה של חשבון משקיע
- שליחת התראות והודעות למשקיעים
- יועץ רואה רק את המשקיעים שהוא יצר

### 4. דף מחשבון
#### 4.1 יצירת מחשבון חדש
- טופס מובנה וקל להבנה
- אפשרות לבחירת תבנית מחשבון קיימת (template)
- שדות:
  - שם המחשבון
  - משקיע (עבור יועצים)
  - הון עצמי (₪)
  - האם יש נכס בישראל? (לצורך משכנתא ישראלית)
  - פרטי משכנתא בישראל (ריבית, תקופה)
  - פרטי משכנתא בקפריסין (ריבית, תקופה)
  - העדפת מימון (בחירה אחת מתוך הרשימה):
    * תזרים חיובי: מעדיף תשלום חודשי נמוך יותר
    * ריבית נמוכה: מעדיף לשלם כמה שפחות ריבית
    * תשואה מקסימלית: מעדיף תשואה נטו כמה שיותר גבוהה
    * מינוף: מעדיף כמה שיותר מימון
    * תקופה ארוכה: מעדיף כמה שיותר שנים
- אפשרות לשמירה כטיוטה
- כפתור עזרה ליד כל שדה עם הסבר מפורט

#### 4.2 מסך מחשבון ראשי
- **פרטי לקוח** (סרגל צד ימין):
  - הון עצמי
  - אפשרויות מימון
  - ריביות משכנתא בישראל וקפריסין
  - העדפות מימון (רק אחת מסומנת)
  - שער חליפין (מתעדכן אוטומטית)

- **טאבים מרכזיים**:
  1. השוואת השקעות
  2. ניתוח רגישות
  3. תזרים מזומנים
  4. משכנתאות ומימון

- **ניווט מהיר**: סרגל קיצורים לניווט בין חלקי המערכת השונים
- **כפתור "הוסף השקעה"** - במיקום בולט למעלה
- **אפשרויות ייצוא** - PDF, Excel, הדפסה
- **כפתור שיתוף** - שליחת קישור למשקיע
- **היסטוריית שינויים** - אפשרות לצפות בגרסאות קודמות של המחשבון

### 5. טאב: השוואת השקעות
- **כרטיסיית השקעה** (לכל השקעה):
  - **כותרת**: שם השקעה, מספר חדרי שינה, תאריך מסירה
  - **פרטי השקעה**:
    * מחיר ללא מע"מ (€ / ₪)
    * מחיר עם מע"מ (€ / ₪)
    * שכירות פוטנציאלית שמרנית (€ / ₪)
    * שכירות מובטחת (אם יש) (€ / ₪)
    * סך עלויות נלוות חד פעמיות (€ / ₪) - עם הסבר בהצבעה (hover)
    * סך הוצאות שנתיות (€ / ₪) - עם הסבר בהצבעה (hover)
    * סך עלות הרכישה (€ / ₪)
    * תשואה לפני מע"מ (%)
    * תשואה נטו (%)
    * תשואה מובטחת (אם יש) (%)
    * תשואה על הון עצמי (%)
    * סכום הלוואה/הלוואות (€ / ₪)
    * החזר חודשי (€ / ₪)
    * תזרים חודשי (€ / ₪) - בצבע ירוק אם חיובי, אדום אם שלילי
  - **כפתורים**: עריכה, מחיקה, שכפול
  - **כפתור "איך חושב?"** - מציג הסבר מפורט על אופן החישוב

- **טבלת השוואה סיכומית** - תציג רק:
  1. עלות כוללת (€ / ₪)
  2. תשואה נטו (%)
  3. תשואה מובטחת (אם יש) (%)
  4. תזרים מזומנים חודשי (€ / ₪)
  5. תזרים מזומנים שנתי (€ / ₪)

- **הסברים**: כל שדה חישובי יכלול אפשרות להצגת הסבר בעת הצבעה (hover)
- **אפשרות סינון והשוואה** - בחירת השקעות ספציפיות להשוואה
- **מיון אוטומטי** - אפשרות למיון לפי כל אחד מהפרמטרים (תשואה, מחיר, תזרים)

### 6. טאב: תזרים מזומנים

- **כרטיסיות סיכום** (5 כרטיסיות בשורה אחת):
  1. **השקעה ראשונית**: הסכום הכולל המושקע (הון עצמי) (€ / ₪)
  2. **תזרים חודשי**: סכום התזרים החודשי (€ / ₪)
  3. **תשואה נטו**: אחוז התשואה עם ספרה אחת אחרי הנקודה העשרונית (%)
  4. **תשואה מובטחת**: אחוז התשואה המובטחת, אם קיימת (%)
  5. **תשואה על ההון העצמי**: אחוז התשואה על ההון העצמי (%)

- **התפלגות הוצאות** (תרשים עוגה):
  - קטגוריות ברורות עם צבעים שונים
  - התווית טקסט מחוץ לעוגה (לא על העוגה עצמה)
  - קטגוריות:
    1. משכנתא (עם פירוט בהצבעה)
    2. דמי ניהול
    3. דמי תיווך
    4. הוצאות נוספות (עם פירוט בהצבעה)

- **תרחישי השכרה** (גרף):
  - תצוגה ברורה עם התוויות מחוץ לגרף
  - השוואה בין תרחישים שונים
  - אפשרות להגדרת תרחישים נוספים (אופטימי, פסימי, מציאותי)

- **תזרים מזומנים לאורך זמן** (גרף קו):
  - הצגת התזרים החודשי הצפוי לאורך 5 שנים
  - תצוגת תזרים מצטבר לאורך זמן (סכום מצטבר)
  - אפשרות להשוואה בין השקעות שונות

### 7. טאב: משכנתאות ומימון

- **המלצת מימון אופטימלית**:
  - תיבת המלצה בולטת עם הסבר
  - סיכום הנתונים הפיננסיים
  - התרעה בולטת באדום כשאין מספיק הון עצמי
  - פירוט המשכנתא/ות המומלצת/ות
  - כפתור "הוסף משכנתא מומלצת אוטומטית"

- **השוואת תרחישי הלוואה**:
  - כרטיסיות לכל תרחיש, עם צבע שונה לכל סוג וסוג
  - צבעים ייחודיים לפי המפתח:
    * ישראל: גווני כחול (כחול כהה, כחול רגיל, כחול בהיר)
    * קפריסין: גווני ירוק (ירוק כהה, ירוק רגיל, ירוק בהיר)
    * היברידי: גווני סגול (סגול כהה, סגול רגיל, סגול בהיר)
  - פירוט תנאי ההלוואה בכל תרחיש
  - הדגשת הפרמטרים הטובים ביותר בכל תרחיש
  - הסבר מפורט על כל סוג משכנתא (בהצבעה או בלחיצה)
  - כפתור "הצג לוח סילוקין" שפותח חלון מידע עם לוח הסילוקין המלא

- **משכנתא אוטומטית**:
  - בעת יצירת נכס חדש, המערכת תייצר אוטומטית משכנתא מומלצת לנכס
  - המשכנתא תיווצר בהתבסס על פרטי הנכס והעדפות המימון

- **לוח סילוקין**:
  - טבלה מפורטת עם תשלומים לפי שנים
  - גרפים להצגת ירידת היתרה לאורך זמן
  - השוואה בין קרן לריבית
  - אפשרות לייצוא הלוח לאקסל

### 8. טאב: ניתוח רגישות
- גרפים ותרשימים שמראים כיצד שינויים בפרמטרים שונים משפיעים על התשואה והתזרים
- פרמטרים לניתוח:
  - שינויים בריבית המשכנתא
  - שינויים במחירי הנכסים
  - שינויים בשכר הדירה
  - שינויים בשער החליפין
- סרגלים אינטראקטיביים לשינוי הפרמטרים בזמן אמת
- הצגת תוצאות מיידית עם עדכון הגרפים

### 9. טופס יצירת/עריכת השקעה
- שדות:
  - בחירת נכס קיים או יצירת נכס חדש
  - שם ההשקעה
  - מחיר ללא מע"מ (€)
  - שכירות פוטנציאלית (€)
  - שכירות מובטחת (אם יש) (€)
  - תאריך מסירה
  - מספר חדרי שינה
  - האם כולל ריהוט? (כן/לא)
  - האם כולל ניהול נכס? (כן/לא)
  - האם כולל דמי תיווך? (כן/לא)
- אפשרות להעלאת תמונות של הנכס
- שדה להערות והארות נוספות
- אפשרות לצרף מסמכים (PDF, תמונות)

### 10. מסך יצירת משקיע חדש
- שדות: שם מלא, כתובת אימייל, טלפון
- יצירה אוטומטית של שם משתמש וסיסמה ראשונית
- אפשרות לשליחת הודעה למשקיע עם פרטי הכניסה שלו
- הגדרת העדפות התקשרות (אימייל, SMS, WhatsApp)
- אפשרות להוספת הערות פנימיות על המשקיע (גלויות רק ליועצים)

### 11. מרכז ניהול התראות
- הצגת כל ההתראות למשתמש בצורה מרוכזת
- אפשרויות סינון וחיפוש התראות
- סימון התראות כנקראו
- הגדרת העדפות התראות (אילו התראות לקבל וכיצד)
- אפשרות למחיקת התראות ישנות

## חלק ד': חישובים והגדרות עסקיות

### 1. עלויות נלוות
- **עורך דין**: 1.5% מהעסקה
- **מס בולים**:
  - 0% עד 5,000€
  - 0.15% בין 5,000€ ל-170,000€
  - 0.20% מעל 170,000€
- **עלויות נוספות קבועות**: 4,000€ (פתיחת חשבון, עמלות, רישום בטאבו, תרגומים ונוטריונים)
- **עלויות משכנתא בישראל**:
  - עלות שמאי: 3,250₪
  - עלויות פתיחת תיק: 1,000₪
- **ריהוט** - לפי מספר חדרי שינה:
  - סטודיו: 9,000€
  - חדר שינה אחד: 10,000€
  - שני חדרי שינה: 13,000€
  - שלושה חדרי שינה: 16,000€

### 2. חישובי תשואה
- **תשואה לפני מע"מ**: שכירות שנתית / מחיר ללא מע"מ
- **תשואה נטו**: (שכירות שנתית - הוצאות שנתיות) / (מחיר כולל מע"מ + עלויות נלוות)
- **תשואה על הון עצמי**: (שכירות שנתית - הוצאות שנתיות - החזרי משכנתא שנתיים) / הון עצמי

### 3. חישובי משכנתא
- **משכנתא בקפריסין**: עד 60% משווי הנכס (ללא מע"מ)
- **משכנתא בישראל**: ללא הגבלה על אחוז המימון (דורש נכס בישראל)
- **משכנתא היברידית**: שילוב של משכנתא בקפריסין ומשכנתא בישראל

### 4. אלגוריתם המלצת מימון
- התחשבות בהעדפת המימון של הלקוח (אחת בלבד)
- בדיקת האפשרויות הזמינות (קפריסין, ישראל, היברידי)
- יצירת אפשרויות מימון שמכסות את העלות הכוללת
- מתן התרעה ברורה כשאין מספיק הון עצמי
- המלצה אוטומטית על האפשרות המתאימה ביותר

### 5. עקביות בהמרות מטבע
- מנגנון וידוא שהמרות מטבע הלוך ושוב מובילות לתוצאות עקביות
- שמירת דיוק בחישובים באמצעות עיגול נכון ועקבי
- התראות על שינויים משמעותיים בשער החליפין

## חלק ה': דרישות כלליות וחוויית משתמש

### 1. מראה ותחושה
- עיצוב נקי ומקצועי
- צבעוניות שמתאימה לחברת תלם נדל"ן:
  - טורקיז (#42b0a6) כצבע ראשי
  - אפור (#696969) כצבע משני
  - לבן (#ffffff) כרקע עיקרי
- דגש על קריאות המידע והגרפים
- אינטראקטיביות (הצבעות, לחיצות, גרירות)
- שילוב לוגו תלם נדל"ן בכל חלקי המערכת

### 2. תמיכה בשפות ומטבעות
- תמיכה מלאה בעברית ואנגלית
- הצגת כל הסכומים הכספיים בשתי מטבעות (€ / ₪)
- עדכון אוטומטי של שער החליפין

### 3. מערכת התראות
- התראות ברורות במקרה של חוסר הון עצמי
- התראות בעת שגיאות הזנה
- אישורים בעת פעולות משמעותיות (מחיקה, שינויים מהותיים)
- מרכז ניהול התראות מרכזי

### 4. תיעוד והסברים
- הסברים בהצבעה (hover) על שדות חישוביים
- כפתור "איך חושב?" לכל שדה חישובי
- עזרה מקוונת זמינה בכל מסך
- מדריך משתמש מלא

### 5. פורמט תאריכים ומספרים
- תאריכים יוצגו בפורמט ישראלי: DD/MM/YYYY
- סכומי כסף יעוגלו למספר שלם (ללא אגורות/סנטים)
- אחוזי תשואה יוצגו עם ספרה אחת אחרי הנקודה העשרונית

### 6. גיבוי ושחזור נתונים
- גיבוי אוטומטי יומי של כל נתוני המערכת
- אפשרות לייצוא נתוני מחשבון לקובץ Excel או PDF

### 7. אבטחה והרשאות
- מערכת JWT לאימות והרשאות
- API Gateway לניטור תעבורה והגנה נוספת
- אימות דו-שלבי (2FA) ליועצים בלבד
- CAPTCHA לאחר 3 ניסיונות כניסה כושלים
- הצפנת נתונים רגישים במסד הנתונים (סיסמאות, נתונים פיננסיים)
- מדיניות סיסמאות חזקה (8 תווים לפחות, תו מיוחד, אות גדולה)
- הגבלת קצב בקשות למניעת התקפות ברוטליות
- לוג פעולות רגישות
- הגבלות גישה מדויקות (יועץ רואה רק משקיעים שהוא יצר)

### 8. תמיכה במכשירים ניידים
- עיצוב רספונסיבי לכל המסכים
- אופטימיזציה לטאבלטים וטלפונים חכמים
- ממשק מותאם למגע עבור טבלאות וגרפים

### 9. נגישות
- תאימות מלאה לתקן WCAG 2.1 AA
- ניגודיות צבעים מתאימה
- תמיכה בניווט מקלדת
- תוויות לקוראי מסך
- אפשרות להגדלת טקסט

## חלק ו': גרפים ותצוגה ויזואלית

### 1. סוגי גרפים נדרשים
- תרשימי עוגה: להתפלגות הוצאות
  - התוויות טקסט מחוץ לעוגה (לא על העוגה עצמה)
- תרשימי עמודות: להשוואת השקעות, תרחישי השכרה
  - תוויות ברורות
- תרשימי קו: לתזרים מזומנים לאורך זמן, לוח סילוקין
- תרשימים משולבים: לניתוחי רגישות

### 2. דרישות מגרפים
- צבעוניות ברורה ומובחנת
- תוויות קריאות (מחוץ לגרף עצמו)
- יכולת אינטראקציה (הצבעה לקבלת מידע נוסף)
- אפשרות הדפסה/ייצוא
- צבעים עקביים לאותם סוגי נתונים בכל הגרפים

### 3. צבעים בהשוואת תרחישי משכנתא
- סוג משכנתא יקבע את קבוצת הצבע:
  * ישראל: גווני כחול (כחול כהה, כחול רגיל, כחול בהיר)
  * קפריסין: גווני ירוק (ירוק כהה, ירוק רגיל, ירוק בהיר)
  * היברידי: גווני סגול (סגול כהה, סגול רגיל, סגול בהיר)
- מספר התרחיש יקבע את עוצמת הצבע (כהה יותר לתרחיש 1, בהיר יותר לתרחיש 3)
- שימוש במקרא ברור להסבר משמעות הצבעים

## חלק ז': אינטגרציה ופיתוח עתידי

### 1. אינטגרציה עם מערכות קיימות
- תכנון API מובנה ומתועד (OpenAPI/Swagger) לאינטגרציה עתידית עם מערכת ה-CRM
- יישום ארכיטקטורת "headless" לאפשר שילוב קל כ"אזור משקיעים" באתר החברה
- API פתוח ומתועד לצורך אינטגרציות עתידיות

### 2. אסטרטגיית פריסה והרחבה
- תכנון המערכת לגידול מ-3 יועצים לעשרות ואף מאות משקיעים
- יכולת הוספת תכונות חדשות בקלות
- מבנה מודולרי שמאפשר הרחבות עתידיות

### 3. תחזוקה ותמיכה
- תיעוד טכני מקיף לצורך תחזוקה עתידית
- ממשק ניהול פשוט למנהל המערכת
- יכולת עדכון פרמטרים עסקיים (ריביות, עלויות, וכו') ללא התערבות מתכנת

## הערות למפתחים:

1. **עקביות חזותית**: שמרו על עקביות בכל חלקי המערכת - אותו מונח צריך להופיע באותה צורה בכל מקום.

2. **חישובים פיננסיים**: כל החישובים הפיננסיים צריכים להיות עקביים ומדויקים. יש להקפיד על נוסחאות זהות בכל רחבי המערכת.

3. **המרות מטבע**: יש להקפיד על המרות שקלים/אירו עקביות ולשים לב שהמרה הפוכה מחזירה את אותה התוצאה.

4. **הנגשה**: המערכת צריכה לתמוך בתקני הנגישות (WCAG 2.1 AA לפחות) כדי לאפשר שימוש לאנשים עם מוגבלויות.

5. **ביצועים**: הקפידו על ביצועים טובים, במיוחד בעת טעינת גרפים ותרשימים או חישובים מורכבים. השתמשו ב-Web Workers לחישובים כבדים.

6. **התאמה לקהל יעד**: יש לזכור שרוב המשקיעים חדשים בשוק הנדל"ן הקפריסאי, ולכן יש להקפיד על ממשק פשוט וברור עם הסברים מקיפים.

7. **שילוב הלוגו**: לוגו תלם נדל"ן צריך להיות משולב באופן עקבי בכל חלקי המערכת, תוך שמירה על צבעי המותג (טורקיז #42b0a6 ואפור #696969).